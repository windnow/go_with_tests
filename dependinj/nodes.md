Внедрение зависимостей
=====================

Существует немало недопонимания вокруг внедрения зависимостей в сообществе программистов. Надеюсь, что это руководство покажет что:

 - Вам не нужен фреймворк
 - Они не усложняют дизайн
 - Облегачет тестирование
 - Позволяют писать великолепные функции общего назначения

Мы хотим написать функцию приветствия, похожую на ту, что мы делали в части hello-world, но на этот раз мы будем тестировать реальный вывод

В общем, функция может выглядеть вот так:
```go
    func Greet(name string){
        fmt.Printf("Hello, %s", name)
    }
```

Но как мы можем протестировать ее? Вызов `fmt.Printf` выводит текст в стандартный поток вывода, что довольно сложно для нас - захватить с помощью фреймворка тестирования.

Все, что нам нужно сделать, это иметь возможность внедрить (просто модное слово для передачи) зависимость при печати

**Нашей функции не нужно заботиться, где или как происходит печать, поэтому мы должны принять интерфейс, а не конкретный тип**

Если мы поступим так, мы можем изменить реализацию печати на что то, что мы контролируем и так мы можем ее протестировать. В "реальной жизни" Вы можете внедрить что то, что пишет в stdout.

Если Вы посмотрите на исходный код `fmt.Printf` вы можете увидете способ подключиться.

```go
    // It returns the number of bytes written and any write error encountered
    func Printf(format string, a ...interface{}) (n int, err error){
        return Fprintf(os.Stdout, format, a...)
    }
```

Интеренсо! Под капотом `Printf` просто вызывает `Fprintf`, передавая в нее `os.Stdout`.

Что из себя представляет `os.Stdout`? Что ожидает `Fprintf` в качестве первого аргумента?

```go
    func Fprint(w io.Writer, a ...interface{}) (n int, err error) {
        p := newPrinter()
        p.doPrint(a)
        n, err = w.Write(p.buf)
        p.free()
        return
    }
```

И `io.Writer`

```go
    type Writer interface {
        Write(p []byte) (n int, err error)
    }
```

После приобретения большего опыта на Go вы заметите, что этот интерфейс используется во множестве вещах, т.к. он является великолепным интерфейсом общего назначения для "помещения данных куда либо"

Теперь мы знаем, что в конечном итоге используется `writer` для отправки кому либо приветствия. Давайте задействуем эту абстракцию, что бы сделать код тестируемым и более пригодным для повторного использования.

## Сначала напишем тесты

